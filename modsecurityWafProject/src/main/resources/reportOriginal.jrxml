<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="null" language="groovy" pageWidth="595" pageHeight="842" columnWidth="535" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="ffcf61c3-11bc-4d9c-8ee9-4ad108d3f8fa">
	<property name="ireport.zoom" value="1.2100000000000006"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="182"/>
	<subDataset name="dataset1" uuid="2492d4ca-bd30-415e-9317-6d7a6be35b4f">
		<field name="campo" class="java.lang.String"/>
		<field name="valor" class="java.lang.Number"/>
	</subDataset>
	<subDataset name="dataset2" uuid="227b68d2-8c30-410c-b6e1-373be5f1ceac">
		<field name="dateEvent" class="java.lang.String"/>
		<field name="destinationPage" class="java.lang.String"/>
		<field name="clientIp" class="java.lang.String"/>
	</subDataset>
	<parameter name="listRuleNumber" class="java.util.List" isForPrompting="false"/>
	<parameter name="listFileNumber" class="java.util.List" isForPrompting="false"/>
	<parameter name="events" class="java.util.List" isForPrompting="false"/>
	<parameter name="SUBREPORT_DIR" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["/home/martin/NetBeansProjects/ModSecurityProyect/modsecurityWafProject/src/main/java/com/fich/wafproject/report/"]]></defaultValueExpression>
	</parameter>
	<background>
		<band/>
	</background>
	<title>
		<band height="72">
			<frame>
				<reportElement mode="Opaque" x="-20" y="-20" width="595" height="92" backcolor="#006699" uuid="9b5aeaf6-b7ec-44e4-a8b0-53cd208f1c75"/>
				<staticText>
					<reportElement x="20" y="43" width="375" height="20" forecolor="#FFFFFF" uuid="bc812774-4bea-4afe-a946-6e73e8f101d3"/>
					<textElement>
						<font fontName="SansSerif" size="14" isBold="true" isUnderline="true"/>
					</textElement>
					<text><![CDATA[REPORTE DE EVENTOS DE MODSECURITY]]></text>
				</staticText>
				<staticText>
					<reportElement x="395" y="43" width="180" height="20" forecolor="#FFFFFF" uuid="2ab354f3-2770-491e-9a5b-a62885105407"/>
					<textElement textAlignment="Right">
						<font fontName="SansSerif" size="12" isBold="true"/>
					</textElement>
					<text><![CDATA[GOBIERNO DE SANTA FE]]></text>
				</staticText>
			</frame>
		</band>
	</title>
	<columnHeader>
		<band height="74">
			<staticText>
				<reportElement x="17" y="11" width="109" height="20" uuid="76dc91e0-8392-4c65-be9c-3289e2060234"/>
				<textElement>
					<font size="12"/>
				</textElement>
				<text><![CDATA[Fecha inicial:]]></text>
			</staticText>
			<staticText>
				<reportElement x="17" y="31" width="109" height="20" uuid="53540a34-4185-4c99-a5b1-78522563a6d3"/>
				<textElement>
					<font size="12"/>
				</textElement>
				<text><![CDATA[Direccion IP:]]></text>
			</staticText>
			<staticText>
				<reportElement x="17" y="51" width="109" height="20" uuid="e3187760-0c82-464c-a888-d481c50b5746"/>
				<textElement>
					<font size="12"/>
				</textElement>
				<text><![CDATA[Servicio atacado:]]></text>
			</staticText>
			<line>
				<reportElement x="0" y="71" width="555" height="1" uuid="778f2d61-7b49-453f-86fe-2fe0da965afc"/>
			</line>
		</band>
	</columnHeader>
	<pageFooter>
		<band height="17">
			<textField>
				<reportElement mode="Opaque" x="0" y="4" width="515" height="13" backcolor="#E6E6E6" uuid="d9f07e0b-394d-4b7b-ba20-7ed067518c55"/>
				<textElement textAlignment="Right">
					<font fontName="SansSerif"/>
				</textElement>
				<textFieldExpression><![CDATA["Page "+$V{PAGE_NUMBER}+" de"]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement mode="Opaque" x="515" y="4" width="40" height="13" backcolor="#E6E6E6" uuid="e80d21ae-9b4a-4220-8db5-17aac3d1d9e3"/>
				<textElement>
					<font fontName="SansSerif"/>
				</textElement>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField pattern="EEEEE dd MMMMM yyyy">
				<reportElement x="0" y="4" width="100" height="13" uuid="fe443c7b-fff3-40b3-9ae7-311041672bcc"/>
				<textElement>
					<font fontName="SansSerif"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
	<summary>
		<band height="608">
			<staticText>
				<reportElement x="148" y="20" width="258" height="20" uuid="68cbc99e-951d-44d4-aaa3-10897c6d3ded"/>
				<text><![CDATA[Cantidad de eventos registrados por cada regla]]></text>
			</staticText>
			<pieChart>
				<chart>
					<reportElement x="121" y="305" width="324" height="212" uuid="6ca11192-940d-46d3-b6cc-d21ad91326e2"/>
					<chartTitle/>
					<chartSubtitle/>
					<chartLegend/>
				</chart>
				<pieDataset>
					<dataset>
						<datasetRun subDataset="dataset1" uuid="7b46042b-82a2-4b02-86d2-711dd153e45a">
							<dataSourceExpression><![CDATA[new net.sf.jasperreports.engine.data.JRBeanCollectionDataSource($P{listFileNumber})]]></dataSourceExpression>
						</datasetRun>
					</dataset>
					<keyExpression><![CDATA[$F{campo}]]></keyExpression>
					<valueExpression><![CDATA[$F{valor}]]></valueExpression>
					<labelExpression><![CDATA[""+$F{valor}]]></labelExpression>
				</pieDataset>
				<piePlot>
					<plot/>
					<itemLabel/>
				</piePlot>
			</pieChart>
			<staticText>
				<reportElement x="124" y="285" width="306" height="20" uuid="ebbb2b61-2d39-4343-86ac-d868b1056120"/>
				<text><![CDATA[Cantidad de eventos registrados por cada tipo de ataque]]></text>
			</staticText>
			<componentElement>
				<reportElement x="0" y="546" width="555" height="22" uuid="c1249666-06b3-4d8d-b9ee-6401e0aebe55"/>
				<jr:list xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" printOrder="Vertical">
					<datasetRun subDataset="dataset2" uuid="ab44d328-5a3d-4e26-853c-34d65b4c6c00">
						<dataSourceExpression><![CDATA[new net.sf.jasperreports.engine.data.JRBeanCollectionDataSource($P{events})]]></dataSourceExpression>
					</datasetRun>
					<jr:listContents height="22" width="555">
						<textField>
							<reportElement x="24" y="0" width="100" height="20" uuid="56eaaa89-927a-46a7-adf9-f536ee446f14"/>
							<textFieldExpression><![CDATA[$F{clientIp}]]></textFieldExpression>
						</textField>
						<textField>
							<reportElement x="126" y="0" width="100" height="20" uuid="0dd1ca18-375a-46a4-85e0-92d85c1129b7"/>
							<textFieldExpression><![CDATA[$F{dateEvent}]]></textFieldExpression>
						</textField>
						<textField>
							<reportElement x="253" y="0" width="100" height="20" uuid="a1a94ecb-cbe9-4039-9d1f-66e0964d7d3f"/>
							<textFieldExpression><![CDATA[$F{destinationPage}]]></textFieldExpression>
						</textField>
					</jr:listContents>
				</jr:list>
			</componentElement>
			<staticText>
				<reportElement x="26" y="526" width="100" height="20" uuid="18866b31-6d12-4a38-8a4f-a2cbcf799303"/>
				<text><![CDATA[IP]]></text>
			</staticText>
			<staticText>
				<reportElement x="126" y="526" width="100" height="20" uuid="00f85fe7-aca1-4a72-910d-0425970145ff"/>
				<text><![CDATA[Fecha]]></text>
			</staticText>
			<staticText>
				<reportElement x="253" y="526" width="100" height="20" uuid="d8d61edc-203f-4d18-a5b3-93f6888a7e15"/>
				<text><![CDATA[Service]]></text>
			</staticText>
			<pieChart>
				<chart>
					<reportElement x="106" y="40" width="324" height="212" uuid="3f06fe12-6bab-4666-8431-a5c05f4a7c55"/>
					<chartTitle/>
					<chartSubtitle/>
					<chartLegend/>
				</chart>
				<pieDataset>
					<dataset>
						<datasetRun subDataset="dataset1" uuid="da66d750-a10c-4c87-ba5e-885a4baa146d">
							<dataSourceExpression><![CDATA[new net.sf.jasperreports.engine.data.JRBeanCollectionDataSource($P{listRuleNumber})]]></dataSourceExpression>
						</datasetRun>
					</dataset>
					<keyExpression><![CDATA[$F{campo}]]></keyExpression>
					<valueExpression><![CDATA[$F{valor}]]></valueExpression>
					<labelExpression><![CDATA[""+$F{valor}]]></labelExpression>
				</pieDataset>
				<piePlot>
					<plot/>
					<itemLabel/>
				</piePlot>
			</pieChart>
		</band>
	</summary>
</jasperReport>
